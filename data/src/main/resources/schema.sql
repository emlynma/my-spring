create table payment_1
(
    id              bigint unsigned auto_increment comment '内部自增主键',
    trade_id        varchar(32)                            not null comment '支付单号（唯一）',
    merchant_id     varchar(32)                            not null comment '商户号',
    out_trade_id    varchar(32)                            not null comment '商户侧订单号（幂等键）',
    exchange_id     varchar(32)                                null comment '资产交换单号',
    uid             bigint unsigned                        not null comment '用户ID',
    amount          bigint unsigned                        not null comment '金额',
    currency        char(3)                                not null comment '币种',
    trade_type      tinyint unsigned                       not null comment '交易类型',
    status          tinyint unsigned default 0             not null comment '交易状态',
    biz_status      tinyint unsigned default 0             not null comment '业务状态',
    error_code      varchar(16)                            null     comment '错误码',
    error_desc      varchar(32)                            null     comment '错误描述',
    extra_info      json        default (json_object())    not null comment '扩展字段(JSON)',
    subject         varchar(256)                           null     comment '订单/商品标题',
    attach          varchar(256)                           null     comment '回传附加数据',
    notify_url      varchar(256)                           null     comment '异步通知地址',
    create_time     datetime    default current_timestamp  not null comment '创建时间',
    update_time     datetime    default current_timestamp  not null on update current_timestamp comment '更新时间',
    finish_time     datetime                               null     comment '完成时间',
    expire_time     datetime                               null     comment '过期时间',
    lock_id         varchar(64)                            null     comment 'DB锁',
    version         int unsigned default 0                 not null comment '乐观锁版本号',
    primary key (id),
    unique key uk_trade_id (trade_id),
    unique key uk_out_trade_id (out_trade_id)
) comment='支付表';

create table refund_1
(
    id                  bigint unsigned auto_increment comment '内部自增主键',
    trade_id            varchar(32)                            not null comment '退款单号（唯一）',
    merchant_id         varchar(32)                            not null comment '商户号',
    out_trade_id        varchar(32)                            not null comment '商户侧退款单号（幂等键）',
    origin_trade_id     varchar(32)                            not null comment '原始交易单号',
    origin_out_trade_id varchar(32)                            not null comment '原始商户侧订单号',
    exchange_id         varchar(32)                                null comment '资产交换单号',
    uid                 bigint unsigned                        not null comment '用户ID',
    amount              bigint unsigned                        not null comment '退款金额',
    currency            char(3)                                not null comment '币种',
    trade_type          tinyint unsigned                       not null comment '交易类型',
    status              tinyint unsigned default 0             not null comment '交易状态',
    error_code          varchar(16)                            null     comment '错误码',
    error_desc          varchar(32)                            null     comment '错误描述',
    extra_info          json        default (json_object())    not null comment '扩展字段(JSON)',
    attach              varchar(256)                           null     comment '回传附加数据',
    notify_url          varchar(256)                           null     comment '异步通知地址',
    create_time         datetime    default current_timestamp  not null comment '创建时间',
    update_time         datetime    default current_timestamp  not null on update current_timestamp comment '更新时间',
    finish_time         datetime                               null     comment '完成时间',
    lock_id             varchar(64)                            null     comment 'DB锁',
    version             int unsigned default 0                 not null comment '乐观锁版本号',
    primary key (id),
    unique key uk_trade_id (trade_id),
    unique key uk_out_trade_id (out_trade_id),
    index idx_origin_trade_id (origin_trade_id)
) comment='退款表';

create table recharge_1
(
    id              bigint unsigned auto_increment comment '内部自增主键',
    trade_id        varchar(32)                            not null comment '支付单号（唯一）',
    channel_id      varchar(32)                            not null comment '渠道号',
    out_trade_id    varchar(32)                            not null comment '渠道侧充值单号（幂等键）',
    exchange_id     varchar(32)                                null comment '资产交换单号',
    uid             bigint unsigned                        not null comment '用户ID',
    amount          bigint unsigned                        not null comment '金额',
    currency        char(3)                                not null comment '币种',
    trade_type      tinyint unsigned                       not null comment '交易类型',
    status          tinyint unsigned default 0             not null comment '交易状态',
    error_code      varchar(16)                            null     comment '错误码',
    error_desc      varchar(32)                            null     comment '错误描述',
    extra_info      json        default (json_object())    not null comment '扩展字段(JSON)',
    create_time     datetime    default current_timestamp  not null comment '创建时间',
    update_time     datetime    default current_timestamp  not null on update current_timestamp comment '更新时间',
    finish_time     datetime                               null     comment '完成时间',
    lock_id         varchar(64)                            null     comment 'DB锁',
    version         int unsigned default 0                 not null comment '乐观锁版本号',
    primary key (id),
    unique key uk_trade_id (trade_id),
    unique key uk_out_trade_id (out_trade_id)
) comment='充值表';

create table withdraw_1
(
    id              bigint unsigned auto_increment comment '内部自增主键',
    trade_id        varchar(32)                            not null comment '提现单号（唯一）',
    channel_id      varchar(32)                            not null comment '渠道号',
    out_trade_id    varchar(32)                            not null comment '渠道侧提现单号（幂等键）',
    exchange_id     varchar(32)                                null comment '资产交换单号',
    uid             bigint unsigned                        not null comment '用户ID',
    amount          bigint unsigned                        not null comment '金额',
    currency        char(3)                                not null comment '币种',
    trade_type      tinyint unsigned                       not null comment '交易类型',
    status          tinyint unsigned default 0             not null comment '交易状态',
    biz_status      tinyint unsigned default 0             not null comment '业务状态',
    error_code      varchar(16)                            null     comment '错误码',
    error_desc      varchar(32)                            null     comment '错误描述',
    extra_info      json        default (json_object())    not null comment '扩展字段(JSON)',
    create_time     datetime    default current_timestamp  not null comment '创建时间',
    update_time     datetime    default current_timestamp  not null on update current_timestamp comment '更新时间',
    finish_time     datetime                               null     comment '完成时间',
    lock_id         varchar(64)                            null     comment 'DB锁',
    version         int unsigned default 0                 not null comment '乐观锁版本号',
    primary key (id),
    unique key uk_trade_id (trade_id),
    unique key uk_out_trade_id (out_trade_id)
) comment='提现表';

create table exchange_1
(
    id                 bigint unsigned auto_increment comment '内部自增主键',
    trade_id           varchar(32)                            not null comment '提现单号（唯一）',
    exchange_id        varchar(32)                                null comment '资产交换单号',
    origin_exchange_id varchar(32)                                null comment '原始交换单号',
    exchange_request   varchar(1024)                          not null comment '资产交换请求',
    exchange_response  varchar(1024)                          not null comment '资产交换响应',
    amount             bigint unsigned                        not null comment '金额',
    currency           char(3)                                not null comment '币种',
    trade_type         tinyint unsigned                       not null comment '交易类型',
    exchange_type      tinyint unsigned                       not null comment '交换类型',
    status             tinyint unsigned default 0             not null comment '交换状态',
    error_code         varchar(16)                            null     comment '错误码',
    error_desc         varchar(32)                            null     comment '错误描述',
    extra_info         json        default (json_object())    not null comment '扩展字段(JSON)',
    create_time        datetime    default current_timestamp  not null comment '创建时间',
    update_time        datetime    default current_timestamp  not null on update current_timestamp comment '更新时间',
    finish_time        datetime                               null     comment '完成时间',
    lock_id            varchar(64)                            null     comment 'DB锁',
    version            int unsigned default 0                 not null comment '乐观锁版本号',
    primary key (id),
    unique key uk_exchange_id (exchange_id)
) comment='资产交换表';
